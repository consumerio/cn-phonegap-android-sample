<!DOCTYPE HTML>
<html>
<head>
<title>Hello CN</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="jquery.mobile-1.1.0-rc.1.min.css" />
<script type="text/javascript" charset="utf-8" src="phonegap-1.4.1.js"></script>
<script type="text/javascript" charset="utf-8" src="jquery-1.7.1.min.js"></script>
<script type="text/javascript" charset="utf-8" src="jquery.mobile-1.1.0-rc.1.min.js"></script>
</head>
<body>

<!-- Start of first page -->
<div data-role="page" id="signinpage">
	<div data-role="header">
		<h1>Hello CN</h1>
	</div><!-- /header -->
	<div data-role="content">
		<p>
			This app shows you all the products that someone has 
			bookmarked on Consumer Notebook.
		</p>
		<p>
		  <label for="username">Username</label>&nbsp;
		  <input id="username" name="username" type="text" value="">
		</p>
		<p>
			<button id="go">Go</button>
		</p>
	</div><!-- /content -->
</div><!-- /page -->

<!-- Start of second page -->
<div data-role="page" id="productlist">

	<div data-role="header">
		<h1><span id="title-username"></span> Products</h1>
	</div><!-- /header -->

	<div data-role="content">
		<ul data-role="listview" data-theme="g" id="products">
		</ul>		
	</div><!-- /content -->

	<div data-role="footer">
		<a href="#signinpage" data-role="button">Back to the sign-in page</a>
	</div><!-- /footer -->
</div><!-- /page -->

<!-- Start of third page -->
<div data-role="page" id="productdetail">

	<div data-role="header">
		<h1>Product Name</h1>
	</div><!-- /header -->

	<div data-role="content">	
		<p>Details about Product Name:</p>
		<div data-role="collapsible">
			<h3>Lists containing it</h3>
			<ul>
				<li>Some List</li>
				<li>Some other list</li>
			</ul>
		</div>
		<div data-role="collapsible">
			<h3>Grids containing it</h3>
			<ul>
				<li>Some Grid</li>
				<li>Some other grid</li>
			</ul>
		</div>		
	</div><!-- /content -->

	<div data-role="footer">
		<a href="#signinpage" data-role="button">Back to the sign-in page</a>
	</div><!-- /footer -->
</div><!-- /page -->

<script type="text/javascript">
var API_KEY = "your-api-key-here";
$("#go").bind("click", function(event, ui){
//	$.support.cors = true;
    var username = $('#username').val();
    $('#title-username').text(username);
    $.ajax({
    	url: "https://consumernotebook.com/api/v1/products/?username=" + username + "&apikey=" + API_KEY,
    	dataType: "jsonp",
    	success: function(data){
    		$.each(data.objects, function(i, val){
    			$('#products').append('<li><a href="#productdetail">' + val.title + '</a></li>');
            });
         	$.mobile.changePage("#productlist");
		}
    });
});
</script>
</body>
</html>
